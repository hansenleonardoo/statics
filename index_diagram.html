<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Kalkulator Keseimbangan dengan Diagram</title>
<style>
body { font-family: Arial; margin:20px; background:#f6f6f6; }
.container{ max-width:900px; margin:auto; background:white; padding:20px; border-radius:12px; box-shadow:0 0 12px #aaa; }
input { margin:5px; padding:5px; }
table, th, td { border:1px solid #444; border-collapse: collapse; padding:6px; }
#diagram { border:1px solid #666; background:white; }
button { padding:8px 16px; margin-top:10px; border-radius:6px; }
</style>
<script>
function addRow(){
    let table=document.getElementById("forceTable");
    let row=table.insertRow(-1);
    row.innerHTML=`<td><input type='number' step='0.01' class='F'></td>
                   <td><input type='number' step='0.01' class='ang'></td>
                   <td><input type='number' step='0.01' class='x'></td>
                   <td><input type='number' step='0.01' class='y'></td>`;
}

function calculate(){
    let F=document.getElementsByClassName("F");
    let ang=document.getElementsByClassName("ang");
    let xs=document.getElementsByClassName("x");
    let ys=document.getElementsByClassName("y");

    let sumFx=0, sumFy=0, sumM=0;

    let canvas=document.getElementById("diagram");
    let ctx=canvas.getContext("2d");
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.lineWidth=2;

    for(let i=0;i<F.length;i++){
        let Fi=parseFloat(F[i].value)||0;
        let a=parseFloat(ang[i].value)||0;
        let x=parseFloat(xs[i].value)||0;
        let y=parseFloat(ys[i].value)||0;

        let rad=a*Math.PI/180;
        let Fx=Fi*Math.cos(rad);
        let Fy=Fi*Math.sin(rad);
        let M=x*Fy - y*Fx;

        sumFx+=Fx;
        sumFy+=Fy;
        sumM+=M;

        // draw arrow
        let scale = 5;
        let px = 200 + x*20;
        let py = 200 - y*20;
        let ex = px + Fx*scale;
        let ey = py - Fy*scale;

        ctx.beginPath();
        ctx.moveTo(px, py);
        ctx.lineTo(ex, ey);
        ctx.strokeStyle="black";
        ctx.stroke();

        // arrow head
        let angle=Math.atan2(py-ey, ex-px);
        ctx.beginPath();
        ctx.moveTo(ex,ey);
        ctx.lineTo(ex-10*Math.cos(angle+0.3), ey+10*Math.sin(angle+0.3));
        ctx.lineTo(ex-10*Math.cos(angle-0.3), ey+10*Math.sin(angle-0.3));
        ctx.closePath();
        ctx.fill();
    }

    document.getElementById("outFx").innerText=sumFx.toFixed(3);
    document.getElementById("outFy").innerText=sumFy.toFixed(3);
    document.getElementById("outM").innerText=sumM.toFixed(3);

    let balance = Math.abs(sumFx)<1e-6 && Math.abs(sumFy)<1e-6 && Math.abs(sumM)<1e-6;
    document.getElementById("status").innerText = balance ? 
        "Sistem dalam keadaan SEIMBANG" : "Sistem TIDAK seimbang";
}
</script>
</head>
<body>
<div class="container">

<h2>Kalkulator Keseimbangan dengan Diagram Gaya</h2>

<button onclick="addRow()">Tambah Gaya</button>
<table id="forceTable">
<tr><th>Gaya (N)</th><th>Sudut (deg)</th><th>Posisi x</th><th>Posisi y</th></tr>
<tr>
<td><input type="number" step="0.01" class="F"></td>
<td><input type="number" step="0.01" class="ang"></td>
<td><input type="number" step="0.01" class="x"></td>
<td><input type="number" step="0.01" class="y"></td>
</tr>
</table>

<br>
<button onclick="calculate()">Hitung & Gambar Diagram</button>

<h3>Hasil</h3>
<p>∑Fx = <span id="outFx">0</span></p>
<p>∑Fy = <span id="outFy">0</span></p>
<p>∑M = <span id="outM">0</span></p>
<h3 id="status"></h3>

<h3>Diagram Gaya</h3>
<canvas id="diagram" width="400" height="400"></canvas>

</div>
</body>
</html>
