<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kalkulator Persamaan Keseimbangan</title>
<style>
  :root{--bg:#f4f7ff;--card:#ffffff;--muted:#6b7280;--accent:#3b82f6}
  body{font-family:Inter,Segoe UI,Arial,sans-serif;background:linear-gradient(135deg,var(--bg),#ffffff);margin:0;padding:24px;}
  .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 20px rgba(60,64,75,.08);max-width:1100px;margin:18px auto}
  h1{margin:0 0 8px;font-size:20px}
  p.lead{margin:0 0 16px;color:var(--muted)}
  .grid{display:grid;grid-template-columns:360px 1fr;gap:18px}
  label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
  input[type=number],select{width:100%;padding:8px;border-radius:8px;border:1px solid #e6e9ef;font-size:14px}
  button{background:var(--accent);color:white;padding:10px 12px;border:0;border-radius:8px;cursor:pointer}
  .row{display:flex;gap:8px;margin-bottom:8px}
  .forces-list{max-height:260px;overflow:auto;padding:6px;border-radius:8px;border:1px dashed #e6e9ef}
  .force-item{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:8px;background:linear-gradient(180deg,#fff,#fbfdff);margin-bottom:8px}
  .small{font-size:13px;color:var(--muted)}
  .result{padding:12px;border-radius:8px;background:#fbfdff;margin-top:12px}
  .canvas-wrap{background:#f8fbff;border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:12px}
  svg{width:100%;height:420px;border-radius:8px;background:linear-gradient(180deg,#ffffff,#f6f9ff);}
  .btn-ghost{background:transparent;border:1px solid #e6e9ef;color:#374151;padding:8px 10px;border-radius:8px;cursor:pointer}
  .muted{color:var(--muted)}
</style>
</head>

<body>
<div class="card">
  <h1>Kalkulator Persamaan Keseimbangan</h1>
  <p class="lead">Masukkan gaya (besar, sudut, lengan momen).</p>

  <div class="grid">

    <!-- LEFT PANEL -->
    <div>
      <label>Tambah Gaya</label>
      <div class="row">
        <input id="mag" type="number" placeholder="Besar gaya (N)" value="100">
        <input id="angle" type="number" placeholder="Sudut (°)" value="-90">
        <input id="arm" type="number" placeholder="Lengan momen (m)" value="0.5">
      </div>

      <div class="row">
        <select id="dir">
          <option value="point">Titik pada balok</option>
          <option value="left">Arah kiri</option>
          <option value="right">Arah kanan</option>
        </select>
        <button id="addBtn">Tambah</button>
        <button id="clearBtn" class="btn-ghost">Hapus Semua</button>
      </div>

      <label>Daftar Gaya</label>
      <div class="forces-list" id="forcesList"></div>

      <div class="result">
        <div><strong>∑Fx</strong> = <span id="sumFx">0.000</span> N</div>
        <div><strong>∑Fy</strong> = <span id="sumFy">0.000</span> N</div>
        <div><strong>∑M</strong> = <span id="sumM">0.000</span> Nm</div>
        <div class="small">Status: <span id="status">-</span></div>
      </div>
    </div>

    <!-- RIGHT PANEL (SVG) -->
    <div class="canvas-wrap">
      <svg id="svg" viewBox="0 0 1200 500">

        <g id="beamGroup">
          <rect x="100" y="220" width="1000" height="20" rx="8" fill="#111827" fill-opacity="0.06"></rect>
          <line x1="100" y1="250" x2="1100" y2="250" stroke="#111827" stroke-opacity="0.06"></line>
          <polygon points="120,260 150,260 135,300" fill="#111827" fill-opacity="0.08"></polygon>
          <polygon points="1060,260 1090,260 1075,300" fill="#111827" fill-opacity="0.08"></polygon>
        </g>

        <g id="forcesGroup"></g>

        <circle cx="600" cy="260" r="4" fill="#374151"></circle>
        <text x="600" y="280" text-anchor="middle" font-size="12" fill="#374151">Titik Referensi</text>

      </svg>

      <div class="small muted">Tambahkan gaya dengan sudut -90° untuk gaya vertikal ke bawah.</div>
    </div>

  </div>
</div>

<script>
let forces = [];
const svg = document.getElementById('svg');
const forcesGroup = document.getElementById('forcesGroup');
const forcesList = document.getElementById('forcesList');
const sumFxEl = document.getElementById('sumFx');
const sumFyEl = document.getElementById('sumFy');
const sumMEl = document.getElementById('sumM');
const statusEl = document.getElementById('status');

function addForce(mag, angleDeg, arm){
  const angle = angleDeg * Math.PI/180;
  const id = Date.now().toString(36);
  forces.push({id, mag:+mag, angleDeg:+angleDeg, angle, arm:+arm});
  renderList(); renderSVG(); compute();
}

function renderList(){
  forcesList.innerHTML = "";

  forces.forEach(f=>{
    const div = document.createElement("div");
    div.className = "force-item";

    div.innerHTML = `
      <div>
        <div><strong>${f.mag} N</strong> <span class="small">@ ${f.angleDeg}°</span></div>
        <div class="small">arm ${f.arm} m</div>
      </div>

      <div style="display:flex;gap:6px;">
        <button class="btn-ghost edit-btn" data-id="${f.id}">Edit</button>
        <button class="btn-ghost delete-btn" data-id="${f.id}">Hapus</button>
      </div>
    `;

    forcesList.appendChild(div);
  });

  // --- Event listener tombol EDIT ---
  document.querySelectorAll('.edit-btn').forEach(btn=>{
    btn.onclick = e => {
      const id = e.target.dataset.id;
      editForce(id);
    };
  });

  // --- Event listener tombol HAPUS ---
  document.querySelectorAll('.delete-btn').forEach(btn=>{
    btn.onclick = e => {
      const id = e.target.dataset.id;
      removeForce(id);
    };
  });
}

    function renderList(){  
  forcesList.innerHTML='';  

  forces.forEach(f=>{  
    const div = document.createElement('div');  
    div.className='force-item';  
    div.innerHTML = `
      <div class="info">
        <div><strong>${f.mag.toFixed(2)} N</strong> <span class="small">@ ${f.angleDeg}°</span></div>
        <div class="small">arm ${f.arm} m</div>
      </div>

      <div class="actions" style="display:flex; gap:6px">
        <button class="btn-ghost edit" data-id="${f.id}">Edit</button>
        <button class="btn-ghost del" data-id="${f.id}">Hapus</button>
      </div>
    `;

    forcesList.appendChild(div);
  });

  // Tombol hapus
  Array.from(document.querySelectorAll('.del')).forEach(b => {
    b.onclick = e => removeForce(e.target.dataset.id);
  });

  // Tombol edit (inline)
  Array.from(document.querySelectorAll('.edit')).forEach(b => {
    b.onclick = e => startEdit(e.target.dataset.id, e.target.closest('.force-item'));
  });
}

    function startEdit(id, container){
  const f = forces.find(x => x.id === id);
  if(!f) return;

  container.innerHTML = `
    <div style="flex:1">
      <input id="editMag" type="number" value="${f.mag}" style="width:80px;margin-right:4px">
      <input id="editAng" type="number" value="${f.angleDeg}" style="width:80px;margin-right:4px">
      <input id="editArm" type="number" value="${f.arm}" style="width:80px">
    </div>

    <div style="display:flex; gap:6px">
      <button class="btn-ghost save">Simpan</button>
      <button class="btn-ghost cancel">Batal</button>
    </div>
  `;

  // SIMPAN perubahan
  container.querySelector('.save').onclick = () => {
    f.mag = parseFloat(container.querySelector('#editMag').value);
    f.angleDeg = parseFloat(container.querySelector('#editAng').value);
    f.angle = f.angleDeg * Math.PI/180;
    f.arm = parseFloat(container.querySelector('#editArm').value);

    renderList();
    renderSVG();
    compute();
  };

  // BATAL (kembali seperti semula)
  container.querySelector('.cancel').onclick = () => renderList();
}
    
function removeForce(id){
  forces = forces.filter(x => x.id !== id);
  renderList(); renderSVG(); compute();
}

function clearAll(){
  forces = [];
  renderList(); renderSVG(); compute();
}

function compute(){
  let Fx=0, Fy=0, M=0;

  forces.forEach(f=>{
    const fx = f.mag * Math.cos(f.angle);
    const fy = f.mag * Math.sin(f.angle);

    Fx += fx;
    Fy += fy;

    M += (-fy) * f.arm;
  });

  sumFxEl.textContent = Fx.toFixed(3);
  sumFyEl.textContent = Fy.toFixed(3);
  sumMEl.textContent = M.toFixed(3);

  if(Math.abs(Fx)<0.01 && Math.abs(Fy)<0.01 && Math.abs(M)<0.01)
    statusEl.textContent = "SEIMBANG";
  else
    statusEl.textContent = "TIDAK SEIMBANG";
}

function renderSVG(){
  forcesGroup.innerHTML = "";
  const refX=600, refY=260, scale=200;

  forces.forEach(f=>{
    const px = refX + f.arm*scale;
    const py = refY;

    const ux = Math.cos(f.angle);
    const uy = Math.sin(f.angle);

    const len = Math.min(140, Math.max(30, Math.abs(f.mag)*0.8));
    const x2 = px + ux*len;
    const y2 = py + uy*len;

    const g = document.createElementNS("http://www.w3.org/2000/svg","g");
    g.innerHTML = `
      <line x1="${px}" y1="${py}" x2="${x2}" y2="${y2}" stroke="#ef4444" stroke-width="4"/>
      <polygon points="${x2},${y2} ${x2-8*ux-6*uy},${y2-8*uy+6*ux} ${x2-8*ux+6*uy},${y2-8*uy-6*ux}" fill="#ef4444"></polygon>
      <circle cx="${px}" cy="${py}" r="4" fill="#111827"></circle>
      <text x="${px+12}" y="${py-12}" font-size="12">${f.mag} N @ ${f.angleDeg}°</text>
      <text x="${px+12}" y="${py+6}" font-size="11" fill="#6b7280">arm ${f.arm} m</text>
    `;

    g.addEventListener("click",()=>{
      if(confirm("Hapus gaya ini?")) removeForce(f.id);
    });

    forcesGroup.appendChild(g);
  });
}

document.getElementById("addBtn").onclick = ()=>{
  addForce(
    parseFloat(mag.value)||0,
    parseFloat(angle.value)||0,
    parseFloat(arm.value)||0
  );
}

document.getElementById("clearBtn").onclick = ()=>{
  if(confirm("Hapus semua gaya?")) clearAll();
}

addForce(200,-90,-1.2);
addForce(200,-90,0.8);
addForce(50,0,0);
</script>
</body>
</html>